<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>DLS 2026 - Complete Professional Edition</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- ===== MENU ===== -->
    <div id="menu">
        <h1>DLS 2026</h1>
        <h2>Real Madrid Career Mode</h2>
        <button onclick="startGame()">BẮT ĐẦU MÙA GIẢI</button>
    </div>

    <!-- ===== HUD ===== -->
    <div id="hud" class="hidden">
        <div id="score">Real Madrid 0 - 0 Barcelona</div>
        <div id="time">00:00</div>
    </div>

    <!-- ===== CAREER INFO ===== -->
    <div id="careerBox" class="hidden">
        <div>Trận: <span id="matchNum">1</span>/6</div>
        <div>Điểm: <span id="points">0</span></div>
        <div>Tiền: $<span id="money">0</span></div>
    </div>

    <!-- ===== COMMENTARY ===== -->
    <div id="commentary" class="hidden"></div>

    <!-- ===== SÂN BÓNG ===== -->
    <div id="field" class="hidden"></div>

    <!-- ===== THAY NGƯỜI ===== -->
    <div id="subPanel" class="hidden">
        <h3>Thay Người</h3>
        <div id="subList"></div>
        <button onclick="closeSub()">Đóng</button>
    </div>

    <!-- ===== CONTROLS MOBILE ===== -->
    <div id="controls" class="hidden">
        <div id="joystick">
            <div id="stick"></div>
        </div>

        <div id="buttons">
            <button onclick="passBall()">PASS</button>
            <button ontouchstart="shootBall()">SHOOT</button>
            <button onclick="openSub()">SUB</button>
        </div>
    </div>

    <script src="game.js"></script>

</body>
</html>
 * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Arial, sans-serif;
}

body {
    background: #0f2027;
    color: white;
    overflow: hidden;
}

/* ===== MENU ===== */
#menu {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(#000428, #004e92);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;
}

#menu h1 {
    font-size: 40px;
    margin-bottom: 10px;
}

#menu h2 {
    margin-bottom: 20px;
}

#menu button {
    padding: 15px 30px;
    font-size: 16px;
    border: none;
    border-radius: 10px;
    background: #00c6ff;
    color: black;
    font-weight: bold;
}

/* ===== HUD ===== */
#hud {
    text-align: center;
    padding: 5px;
    font-weight: bold;
    background: #00000080;
}

/* ===== CAREER BOX ===== */
#careerBox {
    position: absolute;
    top: 0;
    right: 0;
    background: #000000aa;
    padding: 10px;
    font-size: 14px;
    border-bottom-left-radius: 10px;
}

/* ===== COMMENTARY ===== */
#commentary {
    position: absolute;
    bottom: 140px;
    width: 100%;
    text-align: center;
    font-weight: bold;
    color: yellow;
}

/* ===== FIELD ===== */
#field {
    width: 100%;
    height: 520px;
    background: linear-gradient(#1e7f32, #1a6e2b);
    position: relative;
    overflow: hidden;
}

/* ===== PLAYER ===== */
.player {
    position: absolute;
    width: 28px;
    height: 45px;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-size: 8px;
    font-weight: bold;
}

.head {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: #f1c27d;
}

.body {
    width: 22px;
    height: 20px;
    border-radius: 5px;
    margin-top: 2px;
}

.real {
    background: white;
}

.barca {
    background: #a50044;
}

.name {
    margin-top: 2px;
}

.stamina {
    width: 22px;
    height: 3px;
    background: lime;
    margin-top: 2px;
}

/* ===== BALL ===== */
.ball {
    position: absolute;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: white;
}

/* ===== CONTROLS ===== */
#controls {
    position: fixed;
    bottom: 15px;
    width: 100%;
    display: flex;
    justify-content: space-between;
    padding: 0 20px;
}

#joystick {
    width: 100px;
    height: 100px;
    background: #ffffff30;
    border-radius: 50%;
    position: relative;
}

#stick {
    width: 50px;
    height: 50px;
    background: #00c6ff;
    border-radius: 50%;
    position: absolute;
    left: 25px;
    top: 25px;
}

#buttons {
    display: flex;
    flex-direction: column;
}

#buttons button {
    width: 75px;
    height: 75px;
    margin: 5px;
    border-radius: 50%;
    border: none;
    font-weight: bold;
    background: #00c6ff;
}

/* ===== SUB PANEL ===== */
#subPanel {
    position: absolute;
    width: 100%;
    height: 100%;
    background: #000000cc;
    display: flex;
    flex-direction: column;
    align-items: center;
justify-content: center;
    z-index: 20;
}

#subPanel button {
    margin-top: 10px;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    background: #00c6ff;
    font-weight: bold;
}

/* ===== HIDDEN CLASS ===== */
.hidden {
    display: none;
}
// ================= GLOBAL =================
const field = document.getElementById("field");
const scoreBoard = document.getElementById("score");
const timeBoard = document.getElementById("time");
const commentary = document.getElementById("commentary");

let players = [];
let enemies = [];
let ball;

let scoreA = 0;
let scoreB = 0;
let time = 0;

let points = 0;
let money = 500;
let currentOpponent = "Barcelona";

const opponents = ["Barcelona","Man City","PSG"];

const transferMarket = [
{ name:"Haaland", price:500 },
{ name:"Messi", price:700 },
{ name:"Ronaldo", price:650 },
{ name:"De Bruyne", price:600 }
];

// ================= TEAM =================
const realTeam = [
"Courtois","Carvajal","Militao","Alaba","Mendy",
"Bellingham","Modric","Valverde",
"Vinicius","Mbappe","Rodrygo"
];

// ================= CREATE =================
function createPlayer(x,y,name,team){
let p = document.createElement("div");
p.className = "player "+team;
p.style.left = x+"px";
p.style.top = y+"px";

p.innerHTML = `
<div class="head"></div>
<div class="body"></div>
<div class="name">${name}</div>
`;

field.appendChild(p);
return p;
}

function createTeams(){
players=[];
enemies=[];
field.innerHTML="";

createBall();

// 4-3-3 FORMATION
const positions = [
[180,480],[80,420],[140,420],[220,420],[280,420],
[120,340],[180,340],[240,340],
[100,260],[180,240],[260,260]
];

for(let i=0;i<11;i++){
players.push(createPlayer(positions[i][0],positions[i][1],realTeam[i],"real"));
}

// AI team random formation
for(let i=0;i<11;i++){
enemies.push(createPlayer(positions[i][0],80,"AI","enemy"));
}
}

function createBall(){
ball=document.createElement("div");
ball.className="ball";
ball.style.left="180px";
ball.style.top="300px";
field.appendChild(ball);
}

// ================= CONTROL =================
let controlledIndex = 0;

function autoSwitch(){
let min=9999;
players.forEach((p,i)=>{
let dx=parseInt(p.style.left)-parseInt(ball.style.left);
let dy=parseInt(p.style.top)-parseInt(ball.style.top);
let d=Math.sqrt(dx*dx+dy*dy);
if(d<min){min=d;controlledIndex=i;}
});
}

function move(dx,dy){
autoSwitch();
let p=players[controlledIndex];

p.style.left=parseInt(p.style.left)+dx/5+"px";
p.style.top=parseInt(p.style.top)+dy/5+"px";

let dist=Math.abs(parseInt(p.style.left)-parseInt(ball.style.left))+
Math.abs(parseInt(p.style.top)-parseInt(ball.style.top));

if(dist<30){
ball.style.left=p.style.left;
ball.style.top=p.style.top;
}
}

// ================= PASS / SHOOT =================
function passBall(){
ball.style.top=parseInt(ball.style.top)-70+"px";
showComment("Đường chuyền chính xác!");
}

function shootBall(){
ball.style.top=parseInt(ball.style.top)-120+"px";

if(parseInt(ball.style.top)<60){
goalScored();
}
}

function goalScored(){
scoreA++;
money+=200;
updateScore();
showComment("⚽ GOAL REAL MADRID!");
resetBall();
playCrowd();
}

// ================= AI SMART =================
function aiLogic(){
enemies.forEach(ai=>{
let dx=parseInt(ball.style.left)-parseInt(ai.style.left);
let dy=parseInt(ball.style.top)-parseInt(ai.style.top);

ai.style.left=parseInt(ai.style.left)+dx/40+"px";
ai.style.top=parseInt(ai.style.top)+dy/40+"px";

if(Math.abs(dx)<20 && Math.abs(dy)<20){
ball.style.top=parseInt(ball.style.top)+100+"px";
if(parseInt(ball.style.top)>500){
scoreB++;
updateScore();
showComment("⚽ "+currentOpponent+" ghi bàn!");
resetBall();
}
}
});
}

// ================= LEAGUE =================
function nextMatch(){
currentOpponent = opponents[Math.floor(Math.random()*opponents.length)];
time=0;
scoreA=0;
scoreB=0;
createTeams();
updateScore();
showComment("Trận mới vs "+currentOpponent);
}

// ================= TRANSFER =================
function openTransfer(){
let list="";
transferMarket.forEach(p=>{
list+=`${p.name} - $${p.price}\n`;
});
let choice=prompt("Chuyển nhượng:\n"+list+"\nNhập tên cầu thủ:");
if(!choice)return;

let player=transferMarket.find(p=>p.name.toLowerCase()==choice.toLowerCase());
if(player && money>=player.price){
money-=player.price;
players[10].querySelector(".name").innerText=player.name;
alert("Mua thành công "+player.name);
}else{
alert("Không đủ tiền!");
}
}

// ================= SCORE =================
function updateScore(){
scoreBoard.innerText=`Real Madrid ${scoreA} - ${scoreB} ${currentOpponent} | $${money}`;
}

// ================= TIMER =================
setInterval(()=>{
time++;
aiLogic();

let m=Math.floor(time/60);
let s=time%60;
if(s<10)s="0"+s;
timeBoard.innerText=m+":"+s;

if(time>=90){
if(scoreA>scoreB)points+=3;
if(scoreA==scoreB)points+=1;
nextMatch();
}
},200);

// ================= COMMENT =================
function showComment(text){
commentary.classList.remove("hidden");
commentary.innerText=text;
setTimeout(()=>commentary.classList.add("hidden"),2000);
}

// ================= SOUND =================
function playCrowd(){
let audio=new Audio("https://actions.google.com/sounds/v1/crowds/crowd_cheer.ogg");
audio.play();
}
