<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>FIFA MINI WEB ‚Äì FULL</title>
<style>
body{
  background:#0b6623;
  color:white;
  text-align:center;
  font-family:Arial;
}
canvas{
  background:#1e8f3f;
  border:4px solid white;
  display:block;
  margin:auto;
}
button{
  padding:10px 20px;
  font-size:16px;
  cursor:pointer;
  margin:5px;
}
.card{
  width:220px;
  margin:10px auto;
  padding:10px;
  border-radius:10px;
  font-weight:bold;
}
.Common{background:#3498db}
.Rare{background:#2ecc71}
.Epic{background:#9b59b6}
.Legend{background:gold;color:black}
</style>
</head>
<body>

<h1>‚öΩ FIFA MINI WEB ‚Äì FULL</h1>
<p>WASD: Di chuy·ªÉn | J: S√∫t</p>
<button onclick="openPack()">üÉè M·ªû TH·∫∫ C·∫¶U TH·ª¶</button>
<div id="card"></div>

<canvas id="game" width="1000" height="550"></canvas>

<script>
// ===== INPUT =====
const keys = {};
document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

// ===== CANVAS =====
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// ===== TH·∫∫ C·∫¶U TH·ª¶ =====
const cards = [
 {name:"C·∫ßu th·ªß Tr·∫ª",rarity:"Common",speed:2.2,shoot:2.5},
 {name:"Ng√¥i Sao",rarity:"Rare",speed:2.6,shoot:3},
 {name:"Si√™u Sao",rarity:"Epic",speed:3,shoot:3.6},
 {name:"Huy·ªÅn Tho·∫°i",rarity:"Legend",speed:3.5,shoot:4.5}
];

let currentCard = cards[0];
let shootPower = currentCard.shoot;

// ===== M·ªû TH·∫∫ =====
function openPack(){
 const r=Math.random()*100;
 if(r<70) currentCard=cards[0];
 else if(r<90) currentCard=cards[1];
 else if(r<99) currentCard=cards[2];
 else currentCard=cards[3];

 document.getElementById("card").innerHTML=`
 <div class="card ${currentCard.rarity}">
 ${currentCard.rarity.toUpperCase()}<br>
 ${currentCard.name}<br>
 ‚ö° T·ªëc ƒë·ªô: ${currentCard.speed}<br>
 üí• S√∫t: ${currentCard.shoot}
 </div>`;

 user.speed=currentCard.speed;
 shootPower=currentCard.shoot;
}

// ===== C·∫¶U TH·ª¶ =====
function makePlayer(x,y,color,isUser=false,isGK=false){
 return{
  x,y,baseX:x,baseY:y,
  r:isGK?14:10,
  color,
  speed:2.2,
  isUser,
  isGK
 };
}

// ===== ƒê·ªòI H√åNH =====
const teamA=[],teamB=[];
const user = makePlayer(300,275,"blue",true);
teamA.push(makePlayer(40,275,"yellow",false,true));
teamA.push(user);

const posA=[[150,100],[150,250],[150,400],[300,150],[300,400],[450,120],[450,430],[600,275],[600,150],[600,400]];
posA.forEach(p=>teamA.push(makePlayer(p[0],p[1],"cyan")));

teamB.push(makePlayer(960,275,"yellow",false,true));
const posB=[[850,100],[850,250],[850,400],[700,150],[700,400],[550,120],[550,430],[400,275],[550,275],[700,275]];
posB.forEach(p=>teamB.push(makePlayer(p[0],p[1],"red")));

// ===== B√ìNG =====
const ball={x:500,y:275,vx:0,vy:0,r:7};
let scoreA=0,scoreB=0;

// ===== AI =====
function aiMove(p,tx,ty){
 const dx=tx-p.x,dy=ty-p.y;
 const d=Math.hypot(dx,dy);
 if(d>1){
  p.x+=dx/d*p.speed*0.8;
  p.y+=dy/d*p.speed*0.8;
 }
}
function limit(p){
 p.x=Math.max(10,Math.min(canvas.width-10,p.x));
 p.y=Math.max(10,Math.min(canvas.height-10,p.y));
}

// ===== UPDATE =====
function update(){
 // Ng∆∞·ªùi ch∆°i
 if(keys.w) user.y-=user.speed;
 if(keys.s) user.y+=user.speed;
 if(keys.a) user.x-=user.speed;
 if(keys.d) user.x+=user.speed;
 limit(user);

 // AI ƒë·ªôi A
 teamA.forEach(p=>{
  if(p.isUser) return;
  if(Math.hypot(ball.x-p.x,ball.y-p.y)<140)
   aiMove(p,ball.x,ball.y);
  else aiMove(p,p.baseX,p.baseY);
  limit(p);
 });

 // AI ƒë·ªôi B
 teamB.forEach(p=>{
  if(Math.hypot(ball.x-p.x,ball.y-p.y)<140)
   aiMove(p,ball.x,ball.y);
  else aiMove(p,p.baseX,p.baseY);
  limit(p);
 });

 // S√∫t
 const dx=ball.x-user.x,dy=ball.y-user.y;
 if(keys.j && Math.hypot(dx,dy)<18){
  ball.vx=dx*shootPower*0.25;
  ball.vy=dy*shootPower*0.25;
 }

 // B√≥ng
 ball.x+=ball.vx;
 ball.y+=ball.vy;
 ball.vx*=0.97;
 ball.vy*=0.97;

 // Ghi b√†n
 if(ball.x<10 && ball.y>220 && ball.y<330){scoreB++;reset();}
 if(ball.x>990 && ball.y>220 && ball.y<330){scoreA++;reset();}
}

function reset(){
 ball.x=500; ball.y=275;
 ball.vx=ball.vy=0;
}

// ===== V·∫º =====
function drawPlayer(p){
 ctx.beginPath();
 ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
 ctx.fillStyle=p.color;
 ctx.fill();
}

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 ctx.fillStyle="white";
 ctx.fillRect(0,220,10,110);
 ctx.fillRect(990,220,10,110);

 [...teamA,...teamB].forEach(drawPlayer);

 ctx.beginPath();
 ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
 ctx.fillStyle="white";
 ctx.fill();

 ctx.fillText(`ƒê·ªòI B·∫†N ${scoreA} - ${scoreB} ƒê·ªêI TH·ª¶`,420,30);
}

// ===== LOOP =====
function loop(){
 update();
 draw();
 requestAnimationFrame(loop);
}

openPack();
loop();
</script>

</body>
</html>
